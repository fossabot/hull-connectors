{
  "name": "fallbacks",
  "type": "array",
  "default": [{
    "target": "",
    "value": "",
    "unknown": "",
    "sources":[
      {
        "property": ""
      }
    ]
  }],
  "items": {
    "type": "object",
    "required": ["target", "operation"],
    "properties": {
      "target": {
        "title": "Target Attribute",
        "type": "string",
        "pattern": "^[/a-zA-Z_\\-0-9]+$"
      },
      "operation": {
        "title": "Update Strategy",
        "type": "string",
        "default": "set",
        "enumNames": ["Always", "Only if not previously set"],
        "enum": ["set", "setIfNull"]
      },
      "sources": {
        "type": "array",
        "title": "Fallbacks",
        "default": [],
        "items": {
          "type": "object",
          "anyOf": [
            {
              "type": "object",
              "title": "Attribute",
              "properties":{
                "property": {
                  "type": "string",
                  "title": "Attribute"
                }                
              }
            },
            {
              "type": "object",
              "title": "Remapped Attribute",
              "properties": {
                "mapper":{
                  "title": "Remapped Attribute",
                  "required": ["property", "mapping"],
                  "properties": {
                    "property": { "type": "string", "title": "Source attribute" },
                    "mapping": {
                      "title": "Mapping",
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "source": { "type": "string", "title": "Original Value" },
                          "destination": { "type": "string", "title": "Remapped Value" }
                        },
                        "default": [{ "source": "", "destination": ""}]
                      }
                    }
                  }
                }
              }
            },
            
            {
              "type": "object",
              "title": "Static Value",
              "properties":{
                "value": {
                  "type": "string",
                  "title": "Static Value"
                }
              }
            }
          ]
        }
      }
    }
  }
}