{
  "name": "Hubspot",
  "description": "Two-way Hubspot integration for Contacts & Companies",
  "source": "hubspot",
  "logo": "logo.png",
  "picture": "picture.png",
  "version": "0.0.21-monorepo",
  "tags": [
    "outgoing",
    "incoming",
    "batch",
    "batch-accounts",
    "oneColumn",
    "smart-notifier",
    "first-install",
    "single-install",
    "kraken-exports"
  ],
  "settings": [],
  "private_settings": [
    {
      "name": "oauth",
      "title": "Credentials",
      "description": "Authenticate with Hubspot",
      "format": "oauth",
      "type": "string",
      "handler": "oauth",
      "url": "/auth",
      "options": {
        "name": "Hubspot",
        "strategy": {
          "scope": [
            "oauth",
            "contacts",
            "timeline"
          ]
        }
      }
    },
    {
      "name": "last_fetch",
      "type": "string",
      "title": "Last Fetched",
      "format": "information",
      "url": "/last-fetched-status"
    },
    {
      "name": "incoming_user_title",
      "title": "User Incoming Setup",
      "description": "How we capture Hubspot Contacts as users",
      "format": "title",
      "type": "string"
    },
    {
      "name": "incoming_user_claims",
      "title": "User Resolution",
      "description": "Configure which attributes we use to resolve identities between Hull and Hubspot Contacts. _DO NOT map attributes here. use dedicated the setting below_",
      "type": "array",
      "format": "table",
      "items": {
        "type": "object",
        "properties": {
          "service": {
            "title": "Hubspot Identifier",
            "type": "string",
            "format": "select",
            "options": {
              "allowCreate": false,
              "loadOptions": "/schema/incoming_user_claims"
            }
          },
          "hull": {
            "title": "Hull Identifier",
            "enum": [
              "external_id",
              "email"
            ]
          },
          "required": {
            "type": "boolean",
            "title": "required?",
            "format": "select"
          }
        }
      },
      "default": [
        {
          "hull": "email",
          "service": "$['identity-profiles'][*].identities[?(@.type === 'EMAIL')].value",
          "required": false
        },
        {
          "hull": "email",
          "service": "properties.email.value",
          "required": false
        }
      ]
    },
    {
      "name": "incoming_user_attributes",
      "title": "Incoming Attribute Mapping",
      "description": "Define which Attributes are captured from Hubspot into Hull",
      "type": "array",
      "format": "traitMapping",
      "options": {
        "direction": "incoming",
        "showOverwriteToggle": false,
        "placeholder": "Hubspot Contact Field",
        "allowCreate": true,
        "loadOptions": "/schema/contact_properties",
        "source": "hubspot"
      }
    },
    {
      "name": "outgoing_user_title",
      "title": "User Outgoing Setup",
      "description": "How we send Users as Hubspot Contacts",
      "format": "title",
      "type": "string"
    },
    {
      "name": "synchronized_user_segments",
      "title": "User Filter",
      "description": "Send to Hubspot when users match these segments",
      "default": [],
      "type": "array",
      "format": "segment"
    },
    {
      "name": "outgoing_user_attributes",
      "title": "Outgoing Attribute Mapping",
      "description": "Define which Hull User attributes are sent to Hubspot",
      "type": "array",
      "format": "traitMapping",
      "options": {
        "direction": "outgoing",
        "showOverwriteToggle": false,
        "placeholder": "Hubspot Field",
        "allowCreate": true,
        "loadOptions": "/schema/contact_properties"
      }
    },
    {
      "name": "incoming_account_title",
      "title": "Account Incoming Setup",
      "description": "How we capture Hubspot Companies as Accounts",
      "format": "title",
      "type": "string"
    },
    {
      "name": "handle_accounts",
      "title": "Fetch accounts",
      "description": "If this checkbox is disabled we won't get any account in.",
      "type": "boolean",
      "default": false
    },
    {
      "name": "incoming_account_claims",
      "title": "Account Resolution",
      "description": "Configure which attributes we use to resolve identities between Hull and Hubspot Accounts. _DO NOT map attributes here. use dedicated the setting below_",
      "type": "array",
      "format": "table",
      "items": {
        "type": "object",
        "properties": {
          "service": {
            "title": "Hubspot Identifier",
            "type": "string",
            "format": "select",
            "options": {
              "allowCreate": false,
              "loadOptions": "/schema/incoming_account_claims"
            }
          },
          "hull": {
            "title": "Hull Identifier",
            "enum": [
              "external_id",
              "domain"
            ]
          },
          "required": {
            "type": "boolean",
            "title": "required?",
            "format": "select"
          }
        }
      },
      "default": [
        {
          "hull": "domain",
          "service": "properties.domain.value",
          "required": true
        }
      ]
    },
    {
      "name": "incoming_account_attributes",
      "title": "Incoming Attribute Mapping",
      "description": "How we map Accounts and their attributes between Hubspot and Hull",
      "type": "array",
      "format": "accountTraitMapping",
      "options": {
        "direction": "incoming",
        "showOverwriteToggle": false,
        "placeholder": "Hubspot Company Field",
        "allowCreate": true,
        "loadOptions": "/schema/company_properties",
        "source": "hubspot"
      }
    },
    {
      "name": "outgoing_account_title",
      "title": "Account Outgoing Setup",
      "description": "Following section configures how we create or update `Hubspot Companies`",
      "format": "title",
      "type": "string"
    },
    {
      "name": "synchronized_account_segments",
      "title": "Account Filter",
      "description": "Defines the list of Account Segments to send. Nothing sent by default.",
      "default": [],
      "type": "array",
      "format": "accountSegment"
    },
    {
      "name": "outgoing_account_attributes",
      "title": "Outgoing Attribute Mapping",
      "type": "array",
      "format": "accountTraitMapping",
      "options": {
        "direction": "outgoing",
        "showOverwriteToggle": false,
        "placeholder": "Hubspot Company Field",
        "allowCreate": true,
        "loadOptions": "/schema/company_properties"
      }
    },
    {
      "name": "link_users_in_service",
      "title": "Link Contacts in Hubspot",
      "description": "Do you want to let Hull associate Contacts and Companies in Hubspot?",
      "type": "boolean",
      "default": false
    },
    {
      "name": "link_users_in_hull",
      "title": "Link users in Hull",
      "description": "Do you want to let Hubspot update links between Users and Accounts in Hull? Be careful about conflicts with other connectors that would link users too.\n\n**IMPORTANT:** when this checkbox is checked the connector will create a Hull Account for EVERY Hubspot Company any Contact is linked to (refer to documentation for more details).",
      "type": "boolean",
      "default": false
    },
    {
      "name": "token",
      "title": "Token",
      "type": "string",
      "format": "hidden"
    },
    {
      "name": "portal_id",
      "title": "Portal ID",
      "type": "string",
      "format": "hidden"
    },
    {
      "name": "refresh_token",
      "title": "RefreshToken",
      "type": "string",
      "format": "hidden"
    },
    {
      "name": "last_fetch_started_at",
      "description": "Last time fetched at operation was started",
      "type": "string",
      "format": "hidden"
    },
    {
      "name": "fetch_count",
      "description": "Count of contacts already fetched from Hubspot",
      "type": "number",
      "format": "hidden"
    },
    {
      "name": "is_fetch_completed",
      "type": "boolean",
      "default": false,
      "format": "hidden"
    }
  ],
  "deployment_settings": [],
  "resources": [],
  "readme": "readme.md",
  "subscriptions": [
    {
      "url": "/smart-notifier",
      "channels": [
        {
          "channel": "user:update",
          "handler": "user_update"
        },
        {
          "channel": "account:update",
          "handler": "account_update"
        },
        {
          "channel": "ship:update",
          "handler": "ship_update"
        },
        {
          "channel": "users_segment:update",
          "handler": "users_segment_update"
        },
        {
          "channel": "accounts_segment:update",
          "handler": "accounts_segment_update"
        }
      ]
    }
  ],
  "batches": [
    {
      "url": "/batch",
      "channels": [
        {
          "channel": "user:update",
          "handler": "user_update"
        }
      ]
    },
    {
      "url": "/batch-accounts",
      "channels": [
        {
          "channel": "account:update",
          "handler": "account_update"
        }
      ]
    }
  ],
  "statuses": [
    {
      "url": "/status",
      "type": "interval",
      "value": "30",
      "method": "all",
      "handler": "status"
    }
  ],
  "status": {
    "initial_value": "setupRequired",
    "url": "/status",
    "type": "interval",
    "value": "30",
    "method": "all",
    "handler": "status"
  },
  "schedules": [
    {
      "url": "/fetch-recent-contacts",
      "type": "interval",
      "value": "5",
      "handler": "fetch",
      "options": {
        "fireAndForget": true
      }
    },
    {
      "url": "/fetch-recent-companies",
      "type": "interval",
      "value": "5",
      "handler": "fetchRecentCompanies",
      "options": {
        "fireAndForget": true
      }
    },
    {
      "url": "/monitor/checkToken",
      "type": "interval",
      "value": "5",
      "handler": "checkToken",
      "options": {
        "fireAndForget": true
      }
    }
  ],
  "json": [
    {
      "url": "/fetch-all",
      "name": "fetch_all",
      "handler": "fetchAll"
    },
    {
      "title": "Last Fetched",
      "name": "last_fetched",
      "format": "information",
      "url": "/last-fetched",
      "handler": "lastFetchedStatus"
    },
    {
      "title": "Fetch All Contacts",
      "name": "fetch_all_contacts",
      "format": "button",
      "url": "/fetch-all-contacts",
      "handler": "fetchAll",
      "options": {
        "disableErrorHandling": true,
        "confirm": {
          "action": "fetch",
          "entity": "users"
        }
      }
    },
    {
      "title": "Fetch All Companies",
      "name": "fetch_all_companies",
      "format": "button",
      "url": "/fetch-all-companies",
      "handler": "fetchAllCompanies",
      "options": {
        "confirm": {
          "action": "fetch",
          "entity": "accounts"
        }
      }
    },
    {
      "url": "/schema/contact_properties",
      "name": "contact_properties",
      "handler": "getContactProperties",
      "options": {
        "respondWithError": true
      }
    },
    {
      "url": "/schema/incoming_user_claims",
      "name": "incoming_user_claims",
      "handler": "getIncomingUserClaims",
      "options": {
        "respondWithError": false
      }
    },
    {
      "url": "/schema/incoming_account_claims",
      "name": "incoming_account_claims",
      "handler": "getIncomingAccountClaims",
      "options": {
        "respondWithError": false
      }
    },
    {
      "url": "/schema/company_properties",
      "name": "company_properties",
      "handler": "getCompanyProperties"
    }
  ],
  "settings_sections": [
    {
      "title": "Connect with Hubspot",
      "step": "credentials",
      "properties": [
        "private_settings.oauth"
      ]
    },
    {
      "title": "Actions",
      "step": "actions",
      "description": "These are the actions you can perform",
      "properties": [
        "json.fetch_all_contacts",
        "json.fetch_all_companies"
      ]
    },
    {
      "title": "User Incoming Setup",
      "description": "How we capture Hubspot Contacts as users",
      "properties": [
        "private_settings.incoming_user_claims",
        "private_settings.incoming_user_attributes"
      ]
    },
    {
      "title": "User Outgoing Setup",
      "description": "How we send Users as Hubspot Contacts",
      "properties": [
        "private_settings.synchronized_user_segments",
        "private_settings.outgoing_user_attributes"
      ]
    },
    {
      "title": "Account Incoming Setup",
      "description": "How we capture Hubspot Companies as Accounts",
      "properties": [
        "private_settings.handle_accounts",
        "private_settings.incoming_account_claims",
        "private_settings.incoming_user_attributes"
      ]
    },
    {
      "title": "Account Outgoing Setup",
      "description": "Following section configures how we create or update `Hubspot Companies`",
      "properties": [
        "private_settings.synchronized_account_segments",
        "private_settings.outgoing_user_attributes",
        "private_settings.link_users_in_service",
        "private_settings.link_users_in_hull"
      ]
    }
  ]
}
